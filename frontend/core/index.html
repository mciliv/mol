<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="format-detection" content="telephone=no" />
    <title>Atomizer - Molecular Analysis</title>
    <link rel="stylesheet" href="../assets/simple-style.css" />
  </head>
  <body>
    <div class="app-container">
      
      <!-- Payment Section (full width, at top when needed) -->
      <div class="payment-section hidden" id="payment-section">
        <div class="payment-content">
          <div class="payment-header">
            <h2>Payment Required</h2>
            <p>$0.25 per analysis</p>
            <button id="payment-close" class="close-btn">âœ•</button>
          </div>
          
          <form id="payment-form" class="payment-form">
            <div class="form-row">
              <label>Card</label>
              <div id="card-element" class="card-input"></div>
              <div id="card-errors" class="error-text"></div>
            </div>
            
            <div class="form-row">
              <label>Name</label>
              <input type="text" id="user-name" placeholder="Optional" />
            </div>
            
            <button type="submit" id="setup-btn" class="submit-btn">
              <span class="btn-text">Setup</span>
              <span class="btn-loading hidden">...</span>
            </button>
          </form>
        </div>
      </div>

      <!-- Separator -->
      <div class="separator-line" id="separator-line"></div>

      <!-- Main App -->
      <div class="main-app" id="main-app">
        <!-- Input Bar -->
        <div class="input-bar">
          <input
            id="object-input"
            type="text"
            placeholder="Type any molecule name..."
            class="main-input"
          />
          <button id="account-btn" class="account-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="4" width="20" height="16" rx="2"/>
              <line x1="2" y1="10" x2="22" y2="10"/>
            </svg>
            <span id="account-text">Account</span>
          </button>
        </div>

        <!-- Mode Tabs -->
        <div class="mode-section">
          <div class="mode-tabs">
            <label class="mode-tab">
              <input type="checkbox" id="camera-mode" />
              <span class="tab-content">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="5" fill="currentColor" opacity="0.8"/>
                  <circle cx="12" cy="12" r="9" stroke="currentColor" fill="none"/>
                </svg>
                <span>Camera</span>
              </span>
            </label>

            <label class="mode-tab">
              <input type="checkbox" id="photo-mode" />
              <span class="tab-content">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                  <circle cx="9" cy="9" r="2"/>
                  <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                </svg>
                <span>Photo</span>
              </span>
            </label>
          </div>

          <!-- Camera -->
          <div class="camera-area" id="camera-container">
            <video id="video-feed" autoplay playsinline muted></video>
            <div class="camera-crosshair"></div>
            <div class="camera-instruction">Center and tap</div>
          </div>

          <!-- Photo -->
          <div class="photo-area" id="photo-options">
            <input type="file" id="photo-upload" accept="image/*" />
            <label for="photo-upload" class="upload-btn">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7,10 12,15 17,10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              <span>Upload</span>
            </label>

            <div class="url-input-area">
              <input type="url" id="photo-url" placeholder="Image URL..." />
              <button type="button" id="url-analyze" class="analyze-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="M21 21l-4.35-4.35"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Results -->
        <div class="results-container">
          <div class="snapshots-area"></div>
          <div id="gldiv"></div>
        </div>
      </div>

    </div>

    <!-- Scripts -->
    <script type="module" src="../components/simple-payment.js"></script>
    <script type="module" src="../components/camera.js"></script>
    <script type="module" src="../components/camera-handler.js"></script>
    <script type="module" src="../components/ui-utils.js"></script>
    <script src="../components/debug-events.js"></script>
    <script src="../components/error-handler.js"></script>
    <script type="module" src="app.js"></script>
    <script src="https://3Dmol.org/build/3Dmol-min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
  </body>
</html>
